# ==============================================================================
# Файл: gqlgen.yml
# Полный путь: /home/alodi/playground/my-english/backend_v3/gqlgen.yml
# ==============================================================================

# Where are all the schema files located?
schema:
  - graph/schema.graphqls

# Where should the generated server code go?
exec:
  filename: graph/generated.go
  package: graph

# Where should any generated models go?
# Рекомендуется складывать сгенерированные модели (Input objects) в отдельный пакет
model:
  filename: graph/model/models_gen.go
  package: model

# Resolver configuration
resolver:
  layout: follow-schema
  dir: graph
  package: graph
  filename_template: "{name}.resolvers.go"

# Автоматический биндинг Go-структур к GraphQL типам, если имена совпадают
autobind:
  - "github.com/heartmarshall/my-english/internal/model"

# Map GraphQL types to Go types
models:
  ID:
    model:
      - github.com/99designs/gqlgen/graphql.ID
      - github.com/99designs/gqlgen/graphql.IntID
      - github.com/heartmarshall/my-english/graph/scalar.UUID # Добавляем сюда, чтобы ID мог быть UUID

  # Скаляры ссылаются на наш пакет graph/scalar
  # Gqlgen автоматически найдет функции MarshalUUID/UnmarshalUUID и т.д.
  UUID:
    model: github.com/heartmarshall/my-english/graph/scalar.UUID
  
  Time:
    model: github.com/heartmarshall/my-english/graph/scalar.Time
    
  JSON:
    model: github.com/heartmarshall/my-english/graph/scalar.JSON

  # --- DOMAIN ENTITIES ---
  
  # DictionaryEntry мапится на internal/model.DictionaryEntry
  # Для вложенных массивов и вычисляемых полей требуются резолверы (DataLoaders)
  DictionaryEntry:
    model: github.com/heartmarshall/my-english/internal/model.DictionaryEntry
    fields:
      senses:
        resolver: true # SensesByEntryID Loader
      images:
        resolver: true # ImagesByEntryID Loader
      pronunciations:
        resolver: true # PronunciationsByEntryID Loader
      card:
        resolver: true # CardByEntryID Loader
      cardEnabled:
        resolver: true # Computed field (check if card != nil)
      auditLog:
        resolver: true # Direct DB call / Service call

  # Sense мапится на internal/model.Sense
  Sense:
    model: github.com/heartmarshall/my-english/internal/model.Sense
    fields:
      examples:
        resolver: true # ExamplesBySenseID Loader
      translations:
        resolver: true # TranslationsBySenseID Loader
      relations:
        resolver: true # Future implementation

  # Card мапится на internal/model.Card
  Card:
    model: github.com/heartmarshall/my-english/internal/model.Card
    fields:
      reviewHistory:
        resolver: true # Requires arguments (limit), so resolver is mandatory

  # InboxItem мапится на internal/model.InboxItem
  InboxItem:
    model: github.com/heartmarshall/my-english/internal/model.InboxItem

  # --- ENUMS ---
  # Явный маппинг Enums полезен для безопасности типов, 
  # хотя autobind часто справляется сам.
  LearningStatus:
    model: github.com/heartmarshall/my-english/internal/model.LearningStatus
  PartOfSpeech:
    model: github.com/heartmarshall/my-english/internal/model.PartOfSpeech
  EntityType:
    model: github.com/heartmarshall/my-english/internal/model.EntityType
  AuditAction:
    model: github.com/heartmarshall/my-english/internal/model.AuditAction
  ReviewGrade:
    model: github.com/heartmarshall/my-english/internal/model.ReviewGrade