1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –î–∏–∑–∞–π–Ω
üëç –ß—Ç–æ —Ö–æ—Ä–æ—à–æ:
–°–ª–æ–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ transport (GraphQL), service (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞) –∏ repository (–ë–î). –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–¥—É—Ç –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏.
DataLoaders: –¢—ã —Ä–µ—à–∏–ª –ø—Ä–æ–±–ª–µ–º—É N+1 –≤ GraphQL (—Ñ–∞–π–ª graph/dataloader.go). –≠—Ç–æ —á–∞—Å—Ç–∞—è –æ—à–∏–±–∫–∞ –Ω–æ–≤–∏—á–∫–æ–≤, –Ω–æ —Ç—ã —Å–¥–µ–ª–∞–ª –≤—Å—ë –ø—Ä–∞–≤–∏–ª—å–Ω–æ.
Transaction Management: –ü–∞—Ç—Ç–µ—Ä–Ω TxManager + RepositoryFactory –¥–ª—è –ø—Ä–æ–∫–∏–¥—ã–≤–∞–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å ‚Äî —ç—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ, –Ω–∞–¥–µ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –≤ Go (—Ö–æ—Ç—å –∏ –º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω–æ–µ).
ü§î –ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å:
–ê. –î—Ä–∞–π–≤–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (lib/pq vs pgx)
–¢—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å github.com/lib/pq.
–ü—Ä–æ–±–ª–µ–º–∞: –≠—Ç–æ—Ç –¥—Ä–∞–π–≤–µ—Ä –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω –≤ —Ä–µ–∂–∏–º "maintenance only" (–ø–æ–¥–¥–µ—Ä–∂–∫–∞), –Ω–æ–≤—ã–µ —Ñ–∏—á–∏ Postgres –≤ –Ω–µ–º –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è. –û–Ω –º–µ–¥–ª–µ–Ω–Ω–µ–µ –∏ –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç –±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏.
–†–µ—à–µ–Ω–∏–µ: –°—Ç–∞–Ω–¥–∞—Ä—Ç –∏–Ω–¥—É—Å—Ç—Ä–∏–∏ —Å–µ–π—á–∞—Å ‚Äî github.com/jackc/pgx (–≤–µ—Ä—Å–∏–∏ v5). –û–Ω –±—ã—Å—Ç—Ä–µ–µ, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–∏–Ω–∞—Ä–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –∏ –∫—É—á—É –ø–æ–ª–µ–∑–Ω—ã—Ö —Ñ–∏—á (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π).
–ë. –ë–æ–π–ª–µ—Ä–ø–ª–µ–π—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (Scan)
–í –∫–∞–∂–¥–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —É —Ç–µ–±—è –µ—Å—Ç—å —Ñ–∞–π–ª—ã scan.go.
–ü—Ä–æ–±–ª–µ–º–∞: –¢—ã –≤—Ä—É—á–Ω—É—é –º–∞–ø–∏—à—å sql.NullString –≤ –ø–æ–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –ï—Å–ª–∏ –¥–æ–±–∞–≤–∏—à—å –∫–æ–ª–æ–Ω–∫—É –≤ —Ç–∞–±–ª–∏—Ü—É, –ø—Ä–∏–¥–µ—Ç—Å—è –ø—Ä–∞–≤–∏—Ç—å SQL-–∑–∞–ø—Ä–æ—Å, Scan –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É. –≠—Ç–æ —É—Ç–æ–º–∏—Ç–µ–ª—å–Ω–æ –∏ —á—Ä–µ–≤–∞—Ç–æ –æ—à–∏–±–∫–∞–º–∏.
–†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑—É–π –±–∏–±–ª–∏–æ—Ç–µ–∫—É github.com/georgysavva/scany (–¥–ª—è pgx/database/sql) –∏–ª–∏ sqlx. –û–Ω–∏ —É–º–µ—é—Ç –º–∞–ø–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ –±–∞–∑—ã –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ —Ç–µ–≥–∞–º db:"...".
–ü—Ä–∏–º–µ—Ä: –í–º–µ—Å—Ç–æ 20 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: scany.Select(ctx, db, &meanings, query, args...).
–í. Repository Factory (Over-engineering?)
–¢–≤–æ—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è RepositoryFactory –∏ withTx –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–∞ –¥–µ–ª–∞–µ—Ç –∫–æ–¥ –æ—á–µ–Ω—å –≥–∏–±–∫–∏–º, –Ω–æ —Å–ª–æ–∂–Ω—ã–º –¥–ª—è —á—Ç–µ–Ω–∏—è.
–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ß–∞—Å—Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å DBTX (–æ–±—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è *sql.DB –∏ *sql.Tx) –≤ –º–µ—Ç–æ–¥—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç. –ù–æ —Ç–≤–æ–π –ø–æ–¥—Ö–æ–¥ —Ç–æ–∂–µ –≤–∞–ª–∏–¥–µ–Ω, –ø—Ä–æ—Å—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏—è –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–≥–æ –∫–æ–¥–∞ (mocks, factory implementations).